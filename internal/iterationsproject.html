---
layout: internal
---
<html>
<head>
  <style>
    body
    {
      color:#FFFFFF
    }
  </style>
</head>



<div>
    <h1 class="post-title" itemprop="name headline" style="color:white;">Iterations Project</h1>
  <h1 style="color:white;">What is the Iterations Project?</h1>
  <hr />
  <p>WindNinja's momentum solver currently takes significantly more time to run than WindNinja's native conservation of mass solver,
but the momentum solver provides more accurate results than the native solver.
This extra runtime is due in part to different discretization schemes, the way the grids are set up,
and the inclusion of more transport equations.</p>
<br>
    <p>Because WindNinja is designed as an emergency response tool, it trades some accuracy for speed.
This tradeoff is justifiable given the inherent uncertainty regargaring initial and boundary conditions available
to drive the model. One way to reduce simulation time is to reduce the number of iterations performed when running
the conservation of mass and momentum solver. We would like to only run as many iterations as needed to get to
a state where the changes in the predicted wind field are on the order of the uncertainty in the boundary and
intial conditions.</p>
<br>
    <p>The goal of the iterations project was to investigate the impact of stopping the solver at a specified
number of iterations instead of letting it run to complete convergence. Initially, the solver was set to stop
at 200 iterations for "coarse" grid resolutions, 500 iterations for "medium" grid resolutions, and 1000 iterations
for "fine" grid resolutions. This work investigated the suitability of those cutoffs. We attempted to identify
the point at which further iteration induced flow changes primarily in recirculation or eddy zones where the true
flow solution is transient and steady-state predictions should always be interpreted with caution.</p>
<br>
    <p>Since the time of this project, we have performed other experiments to improve the momentum solver speed
while conserving accuracy. This resulted in changes for some of WindNinja's internal settings,
including the number of cells in the mesh for a given resolution. At the time of this study, the mesh for Coarse
resolution consisted of 100,000 cells, the mesh for Medium resolution consisted of 500,000 cells, and the mesh
for Fine resolution consisted of 1,000,000 cells. The number of cells for a given mesh has decreased since the
time of this study. See our <a>Mesh Count Project</a> which is currently not posted, but will be in the next
couple of weeks.</p>
<br>


<h1 style="color:white;">Experimental Methods</h1>
<hr />
    <p>Three elevation files were selected and run with WindNinja's momentum solver for Coarse, Medium, and Fine
grid resolution keeping all variables constant except for the number of iterations.
Variables kept constant were:</p>
<br>
<table align="center">
  <tr><th align="left">Input Wind Height (m)</th><td>10</td><th align="left">Output Wind Height (m)</th><td>10</td></tr>
  <tr><th align="left">Input Wind Speed (mph)</th><td>10</td><th align="left">Output asc Resolution (m)</th><td>same as mesh</td></tr>
  <tr><th align="left">Input Wind Direction (deg)</th><td>220</td><th align="left">Output kmz Resolution (m)</th><td>200</td></tr>
  <tr><th align="left">Vegetation</th><td>grass</td></tr>
</table>
    <br>
    <p>In addition to these settings, the following debugging variable was set to make WindNinja output residual
information to the command line: </p>
<br>
    <table align="center">
      <tr><th>CPL_DEBUG=NINJAFOAM</th></tr>
    </table>
<br>
    <p>WindNinja was then run on a Linux machine with 4 GB of RAM and 4 Intel Xeon e5-1603 processors (2.8 GHz)
for each case using the command line interface. The command line text was redirected to a text file for
evaluation of the residuals. All runs were kept sorted in specific file directories for ease of data analysis
and organization.</p>
<br>
    <p>While a computer ran in the background performing each of the simulations, an R script was written for
analyzing the results. The script took the resulting asc files for each run and set up plots to show the
velocities, angles, and the difference between the velocities and angles at each iteration with the converged
solution. In addition, the R script used a homemade data parser to sift through the command line output text
file to set up plots of all the residuals and runtimes.</p>
<br>

    <h1 style="color:white;">Results</h1>
    <hr />
    <p>The following links go to the results of this study. </p>
  </div>
<br>
  <div>
    <table align="center" width=50%>
      <tr><th><a href="/windninja/internal/IterationsProject/BigButteSmall.html"><i>Big Butte Small</i></a></th><th><a href="/windninja/internal/IterationsProject/SalmonRiver.html"><i>Salmon River</i></a></th><th><a href="/windninja/internal/IterationsProject/Askervein.html"><i>Askervein Hill</i></a></th></tr>
    </table>
  </div>
<br>
  <div>
    <h1 style="color:white;">Analysis of Results</h1>
        <hr />
    <p>It appears that the velocities and angles still change significantly all the way up to complete
convergence. This means that to get results to be as accurate as WindNinja is capable of acheiving, a user
would want to run WindNinja for as many iterations as possible. However, most of these changes occur on the
lee sides of hills or in recirculation zones, places where WindNinja already sacrifices accuracy for speed.
In fact, the WindNinja team found that results for regions outside of the recirculation zones and not on the
lee sides of hills were better than expected for running the momentum solver to fewer iterations.</p>
<br>
    <p>Because WindNinja results showed convergence earlier than expected for regions outside of recirculation
zones and for areas not on the lee sides of hills, the WindNinja team may have the momentum solver in WindNinja
cutoff at fewer iterations for some of the resolutions.</p>
<br>
  </div>

  <a href="http://openfoam.org/"> <img src="http://firelab.github.io/windninja/assets/foam2.png" style="width:175px;height:65px;"> </a>


</body>
