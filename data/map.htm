<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<head>
    <title>Leaflet.draw drawing and editing tools</title>

    <link rel="stylesheet" href="leaflet/leaflet.css"/>
    <link rel="stylesheet" href="leaflet/draw/src/leaflet.draw.css"/>

    <script src="leaflet/leaflet-src.js"></script>

    <script src="leaflet/draw/src/Leaflet.draw.js"></script>
    <script src="leaflet/draw/src/Leaflet.Draw.Event.js"></script>

    <script src="leaflet/draw/src/edit/handler/Edit.Poly.js"></script>
    <script src="leaflet/draw/src/edit/handler/Edit.SimpleShape.js"></script>
    <script src="leaflet/draw/src/edit/handler/Edit.Rectangle.js"></script>
    <script src="leaflet/draw/src/edit/handler/Edit.Marker.js"></script>
    <script src="leaflet/draw/src/edit/handler/Edit.CircleMarker.js"></script>
    <script src="leaflet/draw/src/edit/handler/Edit.Circle.js"></script>

    <script src="leaflet/draw/src/draw/handler/Draw.Feature.js"></script>
    <script src="leaflet/draw/src/draw/handler/Draw.Polyline.js"></script>
    <script src="leaflet/draw/src/draw/handler/Draw.Polygon.js"></script>
    <script src="leaflet/draw/src/draw/handler/Draw.SimpleShape.js"></script>
    <script src="leaflet/draw/src/draw/handler/Draw.Rectangle.js"></script>
    <script src="leaflet/draw/src/draw/handler/Draw.Circle.js"></script>
    <script src="leaflet/draw/src/draw/handler/Draw.Marker.js"></script>
    <script src="leaflet/draw/src/draw/handler/Draw.CircleMarker.js"></script>

    <script src="leaflet/draw/src/ext/TouchEvents.js"></script>
    <script src="leaflet/draw/src/ext/LatLngUtil.js"></script>
    <script src="leaflet/draw/src/ext/GeometryUtil.js"></script>
    <script src="leaflet/draw/src/ext/LineUtil.Intersect.js"></script>
    <script src="leaflet/draw/src/ext/Polyline.Intersect.js"></script>
    <script src="leaflet/draw/src/ext/Polygon.Intersect.js"></script>

    <script src="leaflet/draw/src/Control.Draw.js"></script>
    <script src="leaflet/draw/src/Tooltip.js"></script>
    <script src="leaflet/draw/src/Toolbar.js"></script>

    <script src="leaflet/draw/src/draw/DrawToolbar.js"></script>
    <script src="leaflet/draw/src/edit/EditToolbar.js"></script>
    <script src="leaflet/draw/src/edit/handler/EditToolbar.Edit.js"></script>
    <script src="leaflet/draw/src/edit/handler/EditToolbar.Delete.js"></script>
</head>
<body>
<div id="map" style="width: 800px; height: 600px; border: 1px solid #ccc"></div>
<script>
    var baseMaps = [
     L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
     maxZoom: 17,
     attribution: 'Map data: &copy; <a href="http://www.openstreetmap.org/copyright">' +
     'OpenStreetMap</a>, <a href="http://viewfinderpanoramas.org">SRTM</a>' +
     ' | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a>' +
     '(<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'
    }),
    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
     maxZoom: 18,
     attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
     '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
     'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
     id: 'mapbox.streets'
    }),
    L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.{ext}', {
     attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
     subdomains: 'abcd',
     minZoom: 0,
     maxZoom: 18,
     ext: 'png'
    })
    /*
    L.tileLayer('https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey={apikey}', {
     maxZoom: 22,
     attribution: '&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>,' +
     '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
     apikey: '<your apikey>'
    })
    */
    ];
    var idx = Math.floor(Math.random()*baseMaps.length);
    var mbl = baseMaps[idx];
    var map = new L.Map('map', {layers: [mbl], center: new L.LatLng(43.62455, -113.2971), zoom: 8});
    var mbrLayer = new L.FeatureGroup();
    map.addLayer(mbrLayer);

    var drawControl = new L.Control.Draw({
        position: 'topright',
        draw: {
            polyline: false,
            polygon: false,
            circle: false,
            marker: false,
            circlemarker: false,
            rectangle: true
        },
        edit: {
         featureGroup: mbrLayer,
         remove: true
        }
    });
    map.addControl(drawControl);

    map.on(L.Draw.Event.DRAWSTART, function (e) {
        mbrLayer.clearLayers();
    });

    map.on(L.Draw.Event.CREATED, function (e) {
        mbrLayer.addLayer(e.layer);
        map.addLayer(mbrLayer);
        console.log(mbr());
    });
    function mbr() {
     if(mbrLayer.getLayers().length > 0){
      var b = mbrLayer.getLayers()[0]._bounds;
      return [b._southWest.lng, b._northEast.lng, b._southWest.lat, b._northEast.lat];
     }
     return null;
    }
</script>
</body>
</html>
